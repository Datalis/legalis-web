<div class="thematic-directory container-fluid container-lg px-0 px-md-4 py-4">
  <div class="row">
    <div class="col-lg-4 d-none d-lg-flex bg-blue">
      <div class="subject-grid row align-items-center justify-content-center px-4">
        <div
          class="subject-item col-xl-4 col-lg-6 py-4 mb-4"
          *ngFor="let item of directories$ | async as list"
          (click)="onDirectorySelected(item)"
        >
          <span
            class="subject-icon"
            [innerHtml]="getSVGIconFor(item.icon)"
            [class.active]="currentDirectory?.id === item.id"
          >
          </span>
          <span class="subject-title">{{ item.name }}</span>
        </div>
      </div>
    </div>
    <div class="col-lg-8 col-sm-12">
      <div class="d-flex flex-column ps-lg-4 text-center text-lg-start">
        <h5 class="text-accent mb-1 fw-bold mb-0">DIRECTORIO TEMÁTICO</h5>
        <span class="text-blue text-italic fw-bold">Normativa vigente</span>
      </div>
      <div class="divider"></div>
      <div class="col-12 d-lg-none bg-blue">
        <div class="subject-grid align-items-center justify-content-center px-4">
          <div class="row">
            <div class="subject-item col-4 py-4 mb-4" *ngFor="let item of subjects; let i = index">
              <svg-icon class="subject-icon" src="assets/{{ item.icon }}"></svg-icon>
              <span class="subject-title">{{ item.name }}</span>
            </div>
          </div>
        </div>
      </div>
      <ng-container *ngIf="currentDirectory">
        <div class="d-flex align-items-center my-4 ps-4">
          <img src="/assets/directory-icon-selected.png" alt="" />
          <h6 class="text-blue mx-4 mb-0 fw-bold">{{ currentDirectory?.name }}</h6>
          <span class="text-accent"> {{ currentDirectory?.normatives }} Normativas vigentes relacionadas </span>
        </div>

        <div class="ps-lg-4" *ngIf="normatives$ | async as normatives">
          <ngb-accordion #acc="ngbAccordion" activeIds="ngb-panel-0">
            <ngb-panel
              *ngFor="let item of normatives.results | paginate: { itemsPerPage: 10, currentPage: currentPage }"
            >
              <ng-template ngbPanelTitle>
                <span class="text-accent fw-bold">{{ item.name }}</span>
              </ng-template>
              <ng-template ngbPanelContent>
                <div class="d-flex flex-column">
                  <p class="summary">
                    {{ item.summary || '-- Sin contenido --' }}
                  </p>
                  <span class="text-muted">Publicado en: {{ item.year }}</span>
                  <span class="text-muted">Emisor: {{ item.organism }}</span>
                  <span class="text-muted">Estado: {{ item.state }}</span>
                  <div class="divider-light"></div>
                  <div class="d-flex ms-auto">
                    <a routerLink="/normative/{{ item.id }}" class="me-4">Leer más</a>
                    <a href="#">Descargar <i class="fas fa-download"></i></a>
                  </div>
                </div>
              </ng-template>
            </ngb-panel>
          </ngb-accordion>
          <pagination-controls (pageChange)="currentPage = $event"></pagination-controls>
        </div>
      </ng-container>
      <div *ngIf="!currentDirectory" class="d-flex flex-column align-items-center justify-content-center h-25">
        <span class="text-muted">Seleccione un directorio</span>
      </div>
    </div>
  </div>
</div>
