<div class="thematic-directory container-fluid container-lg px-0 px-md-2 py-4">
  <div class="row" *ngIf="rootDirectories as directories; else loading">
    <div class="col-md-4 d-none d-md-block bg-blue p-2">
      <!--<app-directory-menu class="w-100" [directories]="directories.results" (directorySelected)="onDirectorySelected($event)"></app-directory-menu>-->
      <div class="directory-menu row">
        <a
          *ngFor="let item of directories"
          [routerLink]="['/', rootPath, item.path]"
          routerLinkActive="active"
          class="directory-item col-6 col-lg-4"
        >
          <span class="directory-icon" *ngIf="item.icon" [innerHtml]="getSVGIconFor(item.icon)"></span>
          <span class="directory-icon" *ngIf="!item.icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 108.38 75.98">
              <defs>
                <style>
                  .cls-1 {
                    fill: #74b1e1;
                  }
                </style>
              </defs>
              <title>Asset 3</title>
              <g id="Layer_2" data-name="Layer 2">
                <g id="Layer_1-2" data-name="Layer 1">
                  <path
                    class="cls-1"
                    d="M108.38,20.83a5.28,5.28,0,0,1-2.77,2.43c-3.09,1.45-6.14,3-9.13,4.44V53c2.93,1,3.65,2,3.65,5,0,1.09,0,2.19,0,3.28,0,.35.06.79-.12,1-.93,1.29-.49,2.71-.44,4.08.08,1.94.28,3.87.36,5.81a3,3,0,0,1-3.13,3.31c-1.24,0-2.47,0-3.71,0a3,3,0,0,1-3.14-3.4c.13-2.65.34-5.28.47-7.92a5.4,5.4,0,0,0-.3-1.28c-.55-2.67-.91-5.4.3-7.92.45-.94,1.74-1.46,2.89-2.36V29.25L81.36,35.07c1.35,4.78,2.66,9.53,4,14.25.56,1.89,1.28,3.73,1.91,5.6a6.12,6.12,0,0,1-2,7A76.13,76.13,0,0,1,59.65,75.22a21.24,21.24,0,0,1-13.29-.7A80.91,80.91,0,0,1,23.6,62.41c-2.76-2.12-3.55-4.67-2.37-7.93A152.07,152.07,0,0,0,26.85,35c-.34-.19-.66-.39-1-.55L2.11,22.91C.3,22-.4,20.51.22,18.87a3.25,3.25,0,0,1,2.22-1.94q14.93-5,29.82-10.07C38.43,4.77,44.61,2.7,50.77.6A10,10,0,0,1,57.31.51C63.55,2.6,69.78,4.72,76,6.82a1.78,1.78,0,0,1,1.4,1.42,1.58,1.58,0,0,1-2.25,1.62C72.29,8.92,69.42,7.94,66.56,7l-10-3.38a7,7,0,0,0-4.57,0L4.26,19.67,3.53,20c.31.19.5.35.73.46L51.17,43.3a6.9,6.9,0,0,0,6.4-.16q14.24-7,28.49-13.89l4.32-2.12L60.55,19.34c-1.11,2-3,2.25-5.08,2.15-1.19-.06-2.4,0-3.6,0-3.23,0-5.07-2.31-4.37-5.46a6.83,6.83,0,0,1,13.17-.71,1.44,1.44,0,0,0,1.19,1.1c10.22,2.66,20.46,5.28,30.64,8.08A5.33,5.33,0,0,0,96.81,24c2.61-1.38,5.3-2.62,8.15-4-.49-.2-.79-.34-1.1-.44l-20.72-7c-.23-.08-.47-.15-.7-.24a1.56,1.56,0,0,1-1-2,1.53,1.53,0,0,1,2-1c2.87.94,5.74,1.91,8.61,2.88,4.54,1.53,9.06,3.08,13.61,4.57a4.28,4.28,0,0,1,2.69,2.33ZM83.7,54.25c-3.48,2-6.82,4.15-10.29,6a62.93,62.93,0,0,1-14.78,5.89c-1.21.3-2-.12-2.27-1.07s.35-1.66,1.54-2a75.46,75.46,0,0,0,24-11.73,1,1,0,0,0,.42-1.4c-.9-3-1.79-6-2.63-9-.41-1.45-.72-2.92-1.09-4.46-.44.2-.79.34-1.13.51-6.1,3-12.23,5.92-18.31,9a10.5,10.5,0,0,1-9.92,0c-6.15-3.06-12.34-6-18.51-9-.27-.13-.55-.24-.81-.34a1.55,1.55,0,0,0-.17.25c-1.22,4.44-2.42,8.89-3.67,13.33a1,1,0,0,0,.43,1.21,71.45,71.45,0,0,0,15.71,8.84c2.79,1.15,5.7,2,8.56,3A1.65,1.65,0,0,1,52,65a1.61,1.61,0,0,1-2,1.19c-.35-.07-.69-.15-1-.24a75.94,75.94,0,0,1-17.49-7.61c-2.28-1.31-4.45-2.79-6.68-4.19-1.62,3.18-1,4.48,1.25,6.15a76.66,76.66,0,0,0,18.08,10,48.59,48.59,0,0,0,6.62,2.13,18.72,18.72,0,0,0,10.48-1A78.41,78.41,0,0,0,83,59.82a3.27,3.27,0,0,0,1.43-3.57C84.22,55.54,83.91,54.86,83.7,54.25ZM54.19,18.3h2.64c.7,0,1-.38,1-1.07a3.65,3.65,0,0,0-7.28,0c0,.69.3,1.06,1,1.07C52.43,18.31,53.31,18.3,54.19,18.3Zm42.58,54-.55-8.19H93.63l-.53,8.19ZM92.92,60.74h4c0-1.21.07-2.34,0-3.46a1.31,1.31,0,0,0-.8-1,7.86,7.86,0,0,0-2.42,0,1.13,1.13,0,0,0-.74.79C92.87,58.31,92.92,59.5,92.92,60.74Z"
                  />
                </g>
              </g>
            </svg>
          </span>
          <small class="directory-name">{{ item.name }}</small>
        </a>
      </div>
    </div>
    <div class="col-md-8 col-sm-12">
      <div class="d-flex flex-column ps-lg-4 text-center text-lg-start">
        <h5 class="text-accent mb-1 fw-bold mb-0">DIRECTORIO TEMÁTICO</h5>
        <span class="text-blue text-italic fw-bold">Normativa vigente</span>
      </div>
      <div class="divider"></div>
      <div class="col-12 d-md-none bg-blue">
        <div class="directory-menu row">
          <a
            *ngFor="let item of directories"
            [routerLink]="['/', rootPath, item.path]"
            routerLinkActive="active"
            class="directory-item col-4"
          >
            <span class="directory-icon" *ngIf="item.icon" [innerHtml]="getSVGIconFor(item.icon)"></span>
            <span class="directory-icon" *ngIf="!item.icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 108.38 75.98">
                <defs>
                  <style>
                    .cls-1 {
                      fill: #74b1e1;
                    }
                  </style>
                </defs>
                <title>Asset 3</title>
                <g id="Layer_2" data-name="Layer 2">
                  <g id="Layer_1-2" data-name="Layer 1">
                    <path
                      class="cls-1"
                      d="M108.38,20.83a5.28,5.28,0,0,1-2.77,2.43c-3.09,1.45-6.14,3-9.13,4.44V53c2.93,1,3.65,2,3.65,5,0,1.09,0,2.19,0,3.28,0,.35.06.79-.12,1-.93,1.29-.49,2.71-.44,4.08.08,1.94.28,3.87.36,5.81a3,3,0,0,1-3.13,3.31c-1.24,0-2.47,0-3.71,0a3,3,0,0,1-3.14-3.4c.13-2.65.34-5.28.47-7.92a5.4,5.4,0,0,0-.3-1.28c-.55-2.67-.91-5.4.3-7.92.45-.94,1.74-1.46,2.89-2.36V29.25L81.36,35.07c1.35,4.78,2.66,9.53,4,14.25.56,1.89,1.28,3.73,1.91,5.6a6.12,6.12,0,0,1-2,7A76.13,76.13,0,0,1,59.65,75.22a21.24,21.24,0,0,1-13.29-.7A80.91,80.91,0,0,1,23.6,62.41c-2.76-2.12-3.55-4.67-2.37-7.93A152.07,152.07,0,0,0,26.85,35c-.34-.19-.66-.39-1-.55L2.11,22.91C.3,22-.4,20.51.22,18.87a3.25,3.25,0,0,1,2.22-1.94q14.93-5,29.82-10.07C38.43,4.77,44.61,2.7,50.77.6A10,10,0,0,1,57.31.51C63.55,2.6,69.78,4.72,76,6.82a1.78,1.78,0,0,1,1.4,1.42,1.58,1.58,0,0,1-2.25,1.62C72.29,8.92,69.42,7.94,66.56,7l-10-3.38a7,7,0,0,0-4.57,0L4.26,19.67,3.53,20c.31.19.5.35.73.46L51.17,43.3a6.9,6.9,0,0,0,6.4-.16q14.24-7,28.49-13.89l4.32-2.12L60.55,19.34c-1.11,2-3,2.25-5.08,2.15-1.19-.06-2.4,0-3.6,0-3.23,0-5.07-2.31-4.37-5.46a6.83,6.83,0,0,1,13.17-.71,1.44,1.44,0,0,0,1.19,1.1c10.22,2.66,20.46,5.28,30.64,8.08A5.33,5.33,0,0,0,96.81,24c2.61-1.38,5.3-2.62,8.15-4-.49-.2-.79-.34-1.1-.44l-20.72-7c-.23-.08-.47-.15-.7-.24a1.56,1.56,0,0,1-1-2,1.53,1.53,0,0,1,2-1c2.87.94,5.74,1.91,8.61,2.88,4.54,1.53,9.06,3.08,13.61,4.57a4.28,4.28,0,0,1,2.69,2.33ZM83.7,54.25c-3.48,2-6.82,4.15-10.29,6a62.93,62.93,0,0,1-14.78,5.89c-1.21.3-2-.12-2.27-1.07s.35-1.66,1.54-2a75.46,75.46,0,0,0,24-11.73,1,1,0,0,0,.42-1.4c-.9-3-1.79-6-2.63-9-.41-1.45-.72-2.92-1.09-4.46-.44.2-.79.34-1.13.51-6.1,3-12.23,5.92-18.31,9a10.5,10.5,0,0,1-9.92,0c-6.15-3.06-12.34-6-18.51-9-.27-.13-.55-.24-.81-.34a1.55,1.55,0,0,0-.17.25c-1.22,4.44-2.42,8.89-3.67,13.33a1,1,0,0,0,.43,1.21,71.45,71.45,0,0,0,15.71,8.84c2.79,1.15,5.7,2,8.56,3A1.65,1.65,0,0,1,52,65a1.61,1.61,0,0,1-2,1.19c-.35-.07-.69-.15-1-.24a75.94,75.94,0,0,1-17.49-7.61c-2.28-1.31-4.45-2.79-6.68-4.19-1.62,3.18-1,4.48,1.25,6.15a76.66,76.66,0,0,0,18.08,10,48.59,48.59,0,0,0,6.62,2.13,18.72,18.72,0,0,0,10.48-1A78.41,78.41,0,0,0,83,59.82a3.27,3.27,0,0,0,1.43-3.57C84.22,55.54,83.91,54.86,83.7,54.25ZM54.19,18.3h2.64c.7,0,1-.38,1-1.07a3.65,3.65,0,0,0-7.28,0c0,.69.3,1.06,1,1.07C52.43,18.31,53.31,18.3,54.19,18.3Zm42.58,54-.55-8.19H93.63l-.53,8.19ZM92.92,60.74h4c0-1.21.07-2.34,0-3.46a1.31,1.31,0,0,0-.8-1,7.86,7.86,0,0,0-2.42,0,1.13,1.13,0,0,0-.74.79C92.87,58.31,92.92,59.5,92.92,60.74Z"
                    />
                  </g>
                </g>
              </svg>
            </span>
            <small class="directory-name">{{ item.name }}</small>
          </a>
        </div>
      </div>
      <ng-container *ngIf="currentDirectory as currentDirectory">
        <div class="directory-results mt-3 px-4">
          <h5 class="text-blue mb-2 fw-bold">
            <ng-container *ngFor="let b of breadcrumbs; let i = index">
              <span *ngIf="i !== 0">/</span>
              <a [routerLink]="b.path">{{ b.name }}</a>
            </ng-container>
          </h5>
          <ul class="directory-children">
            <li *ngFor="let child of childDirectories">
              <a [routerLink]="[child.path]">{{ child.name }}</a>
            </li>
          </ul>
          <div class="my-2">
            <span class="text-accent" *ngIf="!currentDirectory.normatives"
              >No hay normativas vigentes relacionadas</span
            >
            <span class="text-accent" *ngIf="currentDirectory.normatives === 1">1 normativa vigente relacionada</span>
            <span class="text-accent" *ngIf="currentDirectory.normatives > 1"
              >{{ currentDirectory.normatives }} normativas vigentes relacionadas</span
            >
          </div>
        </div>
      </ng-container>

      <div class="px-4" *ngIf="normatives$ | async as normatives; else loadingNormative">
        <ng-container
          *ngFor="
            let item of normatives.results
              | paginate
                : {
                    itemsPerPage: itemsPerPage,
                    currentPage: currentPage,
                    totalItems: normatives.count
                  };
            let odd = odd
          "
        >
          <app-normative-item [item]="item"></app-normative-item>
          <div class="my-3"></div>
        </ng-container>

        <!--<ngb-accordion #acc="ngbAccordion" activeIds="ngb-panel-0">
          <ngb-panel
            *ngFor="
              let item of normatives.results
                | paginate: { itemsPerPage: 10, currentPage: currentPage, totalItems: normatives.count }
            "
          >
            <ng-template ngbPanelTitle>
              <span class="text-accent fw-bold">{{ item.name }}</span>
            </ng-template>
            <ng-template ngbPanelContent>
              <div class="d-flex flex-column">
                <p class="summary">
                  {{ item.summary || '-- Sin contenido --' }}
                </p>
                <span class="text-muted">Publicado en: {{ item.year }}</span>
                <span class="text-muted">Emisor: {{ item.organism }}</span>
                <span class="text-muted">Estado: {{ item.state }}</span>
                <div class="divider-light"></div>
                <div class="d-flex ms-auto">
                  <a routerLink="/normative/{{ item.id }}" class="me-4">Leer más</a>
                  <a href="#">Descargar <i class="fas fa-download"></i></a>
                </div>
              </div>
            </ng-template>
          </ngb-panel>
        </ngb-accordion>-->
        <pagination-controls
          *ngIf="normatives.results.length"
          (pageChange)="getPage($event)"
          previousLabel="Atrás"
          nextLabel="Siguiente"
        ></pagination-controls>
      </div>

      <ng-template #loadingNormative>
        <app-loader></app-loader>
      </ng-template>

      <div *ngIf="!currentDirectory" class="d-flex flex-column justify-content-center py-2 px-4">
        <span class="text-muted">Seleccione un directorio</span>
      </div>
    </div>
  </div>
  <ng-template #loading>
    <app-loader></app-loader>
  </ng-template>
</div>
